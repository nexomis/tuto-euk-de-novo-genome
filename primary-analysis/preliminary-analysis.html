<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julien Fouret">

<title>Preliminary Analysis: Contamination Detection and Genome Scoping – De Novo Genome Assembly Tutorial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-3fced2653c1411365395c6308d7f7025.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">De Novo Genome Assembly Tutorial</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-primary-analysis" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Primary Analysis</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-primary-analysis">    
        <li>
    <a class="dropdown-item" href="../primary-analysis/base-calling-qc.html">
 <span class="dropdown-text">Base Calling &amp; QC</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../primary-analysis/preliminary-analysis.html">
 <span class="dropdown-text">Preliminary Analysis</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-secondary-analysis" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Secondary Analysis</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-secondary-analysis">    
        <li>
    <a class="dropdown-item" href="../secondary-analysis/concepts-genome-assembly.html">
 <span class="dropdown-text">Genome Assembly Concepts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../secondary-analysis/contigs-de-novo-assembly.html">
 <span class="dropdown-text">Contigs de novo Assembly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../secondary-analysis/scaffolding.html">
 <span class="dropdown-text">Scaffolding</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../secondary-analysis/assembly-evaluation.html">
 <span class="dropdown-text">Assembly Evaluation</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tertiary-analysis" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tertiary Analysis</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tertiary-analysis">    
        <li>
    <a class="dropdown-item" href="../tertiary-analysis/genome-annotation.html">
 <span class="dropdown-text">Genome Annotation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tertiary-analysis/comparative-genomics.html">
 <span class="dropdown-text">Comparative Genomics</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">More</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-more">    
        <li>
    <a class="dropdown-item" href="../more/reference-enabled-bioinformatics.html">
 <span class="dropdown-text">Reference-enabled Bioinformatics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../more/intro-nextflow.html">
 <span class="dropdown-text">Intro to NextFlow</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-practice" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Practice</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-practice">    
        <li>
    <a class="dropdown-item" href="../hands-on/01-fetch-public-datasets.html">
 <span class="dropdown-text">Fetch Public Datasets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/02-primary-analysis.html">
 <span class="dropdown-text">Primary analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/03-kmer-analysis.html">
 <span class="dropdown-text">Kmer-based Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/04-hybrid-assembly-spades-masurca.html">
 <span class="dropdown-text">Hybrid Assembly (SPAdes/MaSuRCA)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/05-assembly-evaluation.html">
 <span class="dropdown-text">Assembly Evaluation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/06-scaffolding.html">
 <span class="dropdown-text">Secondary scaffolding</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/07-repeats-analysis.html">
 <span class="dropdown-text">Repeats Annotation and Masking</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#preliminary-analysis-contamination-and-genome-scoping" id="toc-preliminary-analysis-contamination-and-genome-scoping" class="nav-link active" data-scroll-target="#preliminary-analysis-contamination-and-genome-scoping"><span class="header-section-number">3</span> Preliminary Analysis: Contamination and Genome Scoping</a>
  <ul class="collapse">
  <li><a href="#contamination-detection" id="toc-contamination-detection" class="nav-link" data-scroll-target="#contamination-detection"><span class="header-section-number">3.1</span> Contamination Detection</a>
  <ul class="collapse">
  <li><a href="#initial-clues-from-fastqc" id="toc-initial-clues-from-fastqc" class="nav-link" data-scroll-target="#initial-clues-from-fastqc"><span class="header-section-number">3.1.1</span> Initial Clues from FastQC</a></li>
  <li><a href="#legacy-approach-fastq-screen" id="toc-legacy-approach-fastq-screen" class="nav-link" data-scroll-target="#legacy-approach-fastq-screen"><span class="header-section-number">3.1.2</span> Legacy Approach: Fastq-Screen</a></li>
  <li><a href="#modern-approach-k-mer-based-classification-with-kraken2" id="toc-modern-approach-k-mer-based-classification-with-kraken2" class="nav-link" data-scroll-target="#modern-approach-k-mer-based-classification-with-kraken2"><span class="header-section-number">3.1.3</span> Modern Approach: K-mer Based Classification with Kraken2</a></li>
  </ul></li>
  <li><a href="#genome-scoping-with-k-mer-analysis" id="toc-genome-scoping-with-k-mer-analysis" class="nav-link" data-scroll-target="#genome-scoping-with-k-mer-analysis"><span class="header-section-number">3.2</span> Genome Scoping with K-mer Analysis</a>
  <ul class="collapse">
  <li><a href="#how-k-mer-scoping-tools-work" id="toc-how-k-mer-scoping-tools-work" class="nav-link" data-scroll-target="#how-k-mer-scoping-tools-work"><span class="header-section-number">3.2.1</span> How K-mer Scoping Tools Work</a></li>
  </ul></li>
  <li><a href="#a-note-on-read-correction" id="toc-a-note-on-read-correction" class="nav-link" data-scroll-target="#a-note-on-read-correction"><span class="header-section-number">3.3</span> A Note on Read Correction</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Preliminary Analysis: Contamination Detection and Genome Scoping</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Julien Fouret </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="preliminary-analysis-contamination-and-genome-scoping" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Preliminary Analysis: Contamination and Genome Scoping</h1>
<p>Before diving into the computationally intensive process of genome assembly, a preliminary analysis of the sequencing data is crucial. This step helps in identifying potential issues like contamination and in estimating key characteristics of the genome. This “genome scoping” allows for a more informed approach to assembly, helping to choose the right tools and parameters.</p>
<section id="contamination-detection" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="contamination-detection"><span class="header-section-number">3.1</span> Contamination Detection</h2>
<p>Sequencing samples can be contaminated with DNA from various sources, such as bacteria, viruses, or even DNA from other organisms handled in the lab. Detecting and understanding this contamination is essential as it can significantly impact the quality of the final assembly.</p>
<section id="initial-clues-from-fastqc" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="initial-clues-from-fastqc"><span class="header-section-number">3.1.1</span> Initial Clues from FastQC</h3>
<p>As we saw in the primary analysis chapter, tools like <strong>FastQC</strong> <span class="citation" data-cites="andrewsFastQCQualityControl2010">(<a href="#ref-andrewsFastQCQualityControl2010" role="doc-biblioref">Andrews 2010</a>)</span> provide a first look at the data quality. The “Per sequence GC content” plot is particularly useful for detecting contamination. A unimodal distribution of GC content is expected for a pure sample. If the plot shows multiple peaks, it may indicate the presence of DNA from different organisms with different GC contents.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="preliminary-analysis/gc.excalidraw.svg" class="img-fluid figure-img"></p>
<figcaption>Contamination from FASTQC</figcaption>
</figure>
</div>
</section>
<section id="legacy-approach-fastq-screen" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="legacy-approach-fastq-screen"><span class="header-section-number">3.1.2</span> Legacy Approach: Fastq-Screen</h3>
<p>A more direct way to identify contamination is to screen the sequencing reads against a panel of genomes from potential contaminants. <strong>Fastq-Screen</strong> <span class="citation" data-cites="wingettFastQScreenTool">(<a href="#ref-wingettFastQScreenTool" role="doc-biblioref">Wingett and Andrews, n.d.</a>)</span> is a tool designed for this purpose. It takes a subset of the reads and aligns them against multiple reference genomes using an aligner like <strong>Bowtie2</strong> <span class="citation" data-cites="langmeadFastGappedreadAlignment2012">(<a href="#ref-langmeadFastGappedreadAlignment2012" role="doc-biblioref">Langmead and Salzberg 2012</a>)</span> or <strong>BWA</strong> <span class="citation" data-cites="liFastAccurateLongread2010">(<a href="#ref-liFastAccurateLongread2010" role="doc-biblioref">Li and Durbin 2010</a>)</span>. The output shows the percentage of reads mapping to each genome, giving a clear picture of the sample’s composition.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="preliminary-analysis/fastqscreen.png" class="img-fluid figure-img"></p>
<figcaption>How to interprete fastqc_sreen from: https://www.bioinformatics.babraham.ac.uk/projects/fastq_screen/</figcaption>
</figure>
</div>
<p>While effective, this alignment-based approach can be time-consuming, especially with large datasets and many potential contaminant genomes.</p>
</section>
<section id="modern-approach-k-mer-based-classification-with-kraken2" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="modern-approach-k-mer-based-classification-with-kraken2"><span class="header-section-number">3.1.3</span> Modern Approach: K-mer Based Classification with Kraken2</h3>
<p>Modern tools have shifted towards alignment-free methods for faster and more efficient taxonomic classification. <strong>Kraken2</strong> <span class="citation" data-cites="woodImprovedMetagenomicAnalysis2019">(<a href="#ref-woodImprovedMetagenomicAnalysis2019" role="doc-biblioref">Wood, Lu, and Langmead 2019</a>)</span> is a widely used tool in this category. It uses a k-mer-based approach to assign a taxonomic label to each read.</p>
<section id="what-are-k-mers" class="level4" data-number="3.1.3.1">
<h4 data-number="3.1.3.1" class="anchored" data-anchor-id="what-are-k-mers"><span class="header-section-number">3.1.3.1</span> What are K-mers?</h4>
<p>A <strong>k-mer</strong> is a substring of length <em>k</em> from a DNA sequence. For example, the sequence <code>AGATTACA</code> has the following 5-mers (k=5): <code>AGATT</code>, <code>GATTA</code>, <code>ATTAC</code>, <code>TTACA</code>.</p>
<p>The core idea behind k-mer-based methods is that every species has a unique set of k-mers in its genome. By breaking down reads into their constituent k-mers and looking them up in a pre-built database, we can rapidly identify the species of origin for each read.</p>
</section>
<section id="how-kraken2-works-speed-and-efficiency" class="level4" data-number="3.1.3.2">
<h4 data-number="3.1.3.2" class="anchored" data-anchor-id="how-kraken2-works-speed-and-efficiency"><span class="header-section-number">3.1.3.2</span> How Kraken2 Works: Speed and Efficiency</h4>
<p>Kraken2 achieves its remarkable speed and memory efficiency through a more sophisticated approach than simply storing all k-mers. Here are the key concepts:</p>
<section id="understanding-minimizers" class="level5" data-number="3.1.3.2.1">
<h5 data-number="3.1.3.2.1" class="anchored" data-anchor-id="understanding-minimizers"><span class="header-section-number">3.1.3.2.1</span> Understanding Minimizers</h5>
<p>Instead of storing every k-mer, Kraken2 works with <strong>minimizers</strong>. A minimizer is the lexicographically smallest substring of length ℓ found within a k-mer (including its reverse complement). This concept dramatically reduces storage requirements.</p>
<p>Let’s illustrate with a simple example using 5-mers and minimizers of length 3:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Position</th>
<th>5-mer</th>
<th>All 3-mers in 5-mer</th>
<th>Minimizer (smallest)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>ATCGG</td>
<td>ATC, TCG, CGG</td>
<td>ATC</td>
</tr>
<tr class="even">
<td>2</td>
<td>TCGGA</td>
<td>TCG, CGG, GGA</td>
<td>CGG</td>
</tr>
<tr class="odd">
<td>3</td>
<td>CGGAT</td>
<td>CGG, GGA, GAT</td>
<td>CGG</td>
</tr>
<tr class="even">
<td>4</td>
<td>GGATC</td>
<td>GGA, GAT, ATC</td>
<td>ATC</td>
</tr>
</tbody>
</table>
<p>Notice how consecutive k-mers often share the same minimizer (CGG appears in positions 2 and 3). This property means that instead of storing 4 different 5-mers, we only need to store 2 minimizers, significantly reducing storage requirements.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="preliminary-analysis/kraken2.png" class="img-fluid figure-img"></p>
<figcaption>Differences in operation between Kraken and Kraken2</figcaption>
</figure>
</div>
<p><strong>How Kraken2 uses minimizers:</strong></p>
<ul>
<li><p><strong>Storage of Minimizers</strong>: For each k-mer, Kraken2 computes its minimizer and stores only the minimizer in the database, not the full k-mer. The Lowest Common Ancestor (LCA) of a k-mer is assumed to be the same as its minimizer’s LCA.</p></li>
<li><p><strong>Spaced Seeds</strong>: To improve classification accuracy, Kraken2 uses <strong>spaced seeds</strong> where certain positions in the minimizer are masked (not considered during search). Starting from the next-to-rightmost position, every other position is masked until the specified number of positions are masked. This approach increases sensitivity while decreasing specificity, allowing better detection of related sequences with mutations.</p></li>
<li><p><strong>Compact Hash Table</strong>: The database itself is not a simple list but a <strong>compact hash table</strong>. This is a probabilistic data structure that maps minimizers to their taxonomic LCA. It allows for extremely fast queries and low memory usage. However, being a probabilistic structure, it has a very small chance of returning an incorrect result. This is a trade-off for its speed, and users can apply confidence scoring thresholds to filter out low-confidence assignments and mitigate this possibility.</p></li>
</ul>
<p>This combination of techniques avoids the need for slow alignment algorithms and makes it possible to classify millions of reads in minutes, even on a standard laptop.</p>
<p>The output of Kraken2 is a report that details the taxonomic composition of the sample, allowing for precise identification of the target organism and any contaminants.</p>
</section>
</section>
<section id="choosing-a-kraken2-database" class="level4" data-number="3.1.3.3">
<h4 data-number="3.1.3.3" class="anchored" data-anchor-id="choosing-a-kraken2-database"><span class="header-section-number">3.1.3.3</span> Choosing a Kraken2 Database</h4>
<p>One of the key advantages of Kraken2 is the availability of pre-built databases that can be easily downloaded and used. The <a href="https://benlangmead.github.io/aws-indexes/k2">Index Zone by Ben Langmead</a> provides regularly updated databases with different taxonomic coverage:</p>
<ul>
<li><p><strong>MinusB</strong>: Contains RefSeq archaea, viral, plasmid, human, and UniVec_Core sequences (~10 GB). This database excludes bacterial genomes, making it useful for detecting non-bacterial contamination.</p></li>
<li><p><strong>Standard</strong>: The most commonly used database, containing RefSeq archaea, bacteria, viral, plasmid, human, and UniVec_Core sequences (~87 GB). This provides broad taxonomic coverage for most contamination detection needs.</p></li>
<li><p><strong>PlusPF</strong>: Extends the Standard database with protozoa and fungi (~93 GB), useful for eukaryotic samples that might contain these contaminants.</p></li>
<li><p><strong>core_nt</strong>: A massive database containing sequences from GenBank, RefSeq, TPA, and PDB (~278 GB). This comprehensive collection demonstrates the true scalability advantage of k-mer-based methods.</p></li>
</ul>
<p>The ability to use such large databases like <code>core_nt</code> highlights a fundamental advantage of Kraken2 over alignment-based methods. While building Bowtie2 or BWA indexes for hundreds of gigabytes of reference sequences would be computationally prohibitive and memory-intensive, Kraken2’s k-mer-based approach makes this scale of analysis practical and fast. This scalability is what enables comprehensive contamination screening that would be unrealistic with traditional alignment approaches.</p>
</section>
</section>
</section>
<section id="genome-scoping-with-k-mer-analysis" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="genome-scoping-with-k-mer-analysis"><span class="header-section-number">3.2</span> Genome Scoping with K-mer Analysis</h2>
<p>Beyond contamination detection, k-mer analysis is a powerful technique for estimating key genome characteristics directly from the raw sequencing reads, without the need for an assembly. Tools like <strong>KmerGenie</strong> and <strong>KAT (K-mer Analysis Toolkit)</strong> are specialized for this purpose.</p>
<section id="how-k-mer-scoping-tools-work" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="how-k-mer-scoping-tools-work"><span class="header-section-number">3.2.1</span> How K-mer Scoping Tools Work</h3>
<p>The foundation of genome scoping is fast and efficient k-mer counting. Tools like KAT are often built upon specialized k-mer counting engines like <strong>Jellyfish</strong>. Jellyfish is designed to count k-mers using an order of magnitude less memory and time compared to other methods. It achieves this through several key innovations:</p>
<ul>
<li><p><strong>Memory-Efficient Hash Table</strong>: It uses a highly optimized, memory-efficient hash table structure to store and count the k-mers, minimizing the RAM footprint. Jellyfish exploits the fact that a k-mer’s position in the hash table already encodes part of its information. By using bijective hash functions, it can store only the high-order bits of the encoded k-mer, significantly reducing the storage space per k-mer.</p></li>
<li><p><strong>Parallelism</strong>: It is designed for modern multi-core processors and uses lock-free data structures by exploiting the “compare-and-swap” CPU instruction. This allows multiple threads to count k-mers in parallel with minimal overhead, dramatically increasing speed.</p></li>
</ul>
<p>By using such an efficient engine, tools like KAT can process massive sequencing datasets quickly to generate a <strong>k-mer spectrum</strong>—a frequency plot showing how many k-mers appear a certain number of times. This plot provides a wealth of information:</p>
<ul>
<li><strong>Genome Size</strong>: The total number of unique k-mers in the genome can be estimated from the main peak of the k-mer spectrum.</li>
<li><strong>Ploidy and Heterozygosity</strong>: In a diploid organism, heterozygous sites will create unique k-mers for each allele, resulting in a peak at half the coverage of the main homozygous peak. The size of this heterozygous peak relative to the homozygous peak can be used to estimate the overall heterozygosity of the genome.</li>
<li><strong>Contamination</strong>: Contamination can sometimes be seen as additional, smaller peaks in the k-mer spectrum.</li>
<li><strong>Repeat Content</strong>: A large number of high-frequency k-mers can indicate a high proportion of repetitive elements in the genome.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="preliminary-analysis/kmer-spectra.excalidraw.svg" class="img-fluid figure-img"></p>
<figcaption>Example of k-mer spectrum from <a href="https://kat.readthedocs.io/en/latest/kmer.html" class="uri">https://kat.readthedocs.io/en/latest/kmer.html</a></figcaption>
</figure>
</div>
<p>This analysis is invaluable for planning the assembly. For example, a highly heterozygous or repetitive genome might require a specific type of assembly algorithm or long-read data to resolve correctly.</p>
</section>
</section>
<section id="a-note-on-read-correction" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="a-note-on-read-correction"><span class="header-section-number">3.3</span> A Note on Read Correction</h2>
<p>Sequencing technologies are not perfect and introduce errors into the reads. These errors can complicate the assembly process by creating false k-mers and breaking contiguity. <strong>Read correction</strong> algorithms aim to identify and fix these errors before assembly.</p>
<p>These algorithms often work by using a k-mer-based approach. They build a k-mer spectrum from the data and assume that low-frequency k-mers are likely to be erroneous. They then try to “correct” these erroneous k-mers by changing them to high-frequency k-mers that are a small edit distance away.</p>
<p>While standalone read correction tools exist, it’s important to note that most modern genome assembly software, such as <strong>SPAdes</strong> or <strong>MaSuRCA</strong>, have their own built-in error correction modules. These integrated modules are often optimized for the specific assembly algorithm being used. Therefore, we will not run a separate read correction step but will instead rely on the capabilities of the assemblers we will use in the upcoming chapters.</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-andrewsFastQCQualityControl2010" class="csl-entry" role="listitem">
Andrews, Simon. 2010. <em><span>FastQC</span>: <span>A</span> Quality Control Tool for High Throughput Sequence Data.</em>
</div>
<div id="ref-langmeadFastGappedreadAlignment2012" class="csl-entry" role="listitem">
Langmead, Ben, and Steven L Salzberg. 2012. <span>“Fast Gapped-Read Alignment with <span>Bowtie</span> 2.”</span> <em>Nature Methods</em> 9 (4): 357–59. <a href="https://doi.org/10.1038/nmeth.1923">https://doi.org/10.1038/nmeth.1923</a>.
</div>
<div id="ref-liFastAccurateLongread2010" class="csl-entry" role="listitem">
Li, Heng, and Richard Durbin. 2010. <span>“Fast and Accurate Long-Read Alignment with <span>Burrows-Wheeler</span> Transform.”</span> <em>Bioinformatics (Oxford, England)</em> 26 (5): 589–95. <a href="https://doi.org/10.1093/bioinformatics/btp698">https://doi.org/10.1093/bioinformatics/btp698</a>.
</div>
<div id="ref-wingettFastQScreenTool" class="csl-entry" role="listitem">
Wingett, Steven W, and Simon Andrews. n.d. <span>“<span>FastQ Screen</span>: <span>A</span> Tool for Multi-Genome Mapping and Quality Control.”</span>
</div>
<div id="ref-woodImprovedMetagenomicAnalysis2019" class="csl-entry" role="listitem">
Wood, Derrick E., Jennifer Lu, and Ben Langmead. 2019. <span>“Improved Metagenomic Analysis with <span>Kraken</span> 2.”</span> <em>Genome Biology</em> 20 (1). <a href="https://doi.org/10.1186/s13059-019-1891-0">https://doi.org/10.1186/s13059-019-1891-0</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/nexomis\.github\.io\/tuto-euk-de-novo-genome\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>